{"version":3,"file":"v-money-persian.cjs.min.js","sources":["../src/options.js","../src/utils.persian.js","../src/utils.js","../src/assign.js","../src/directive.js","../src/component.vue","../src/index.js"],"sourcesContent":["export default {\n  prefix: '',\n  suffix: '',\n  thousands: ',',\n  decimal: '.',\n  precision: 2\n}\n","const persianToEnglishMapper = {\n  '۱': 1,\n  '۲': 2,\n  '۳': 3,\n  '۴': 4,\n  '۵': 5,\n  '۶': 6,\n  '۷': 7,\n  '۸': 8,\n  '۹': 9,\n  '۰': 0\n}\n\nfunction mapChars(input, mapper) {\n  return input.split('').map(char => {\n    return mapper[char] || char;\n  }).join('');\n}\n\nexport function persianToEnglish(input) {\n  return mapChars(input, persianToEnglishMapper);\n}\n","import defaults from './options'\nimport { persianToEnglish } from './utils.persian.js'\n\nfunction format (input, opt = defaults) {\n  if (typeof input === 'number') {\n    input = input.toFixed(fixed(opt.precision))\n  } else {\n    input = persianToEnglish(input)\n  }\n  var negative = input.indexOf('-') >= 0 ? '-' : ''\n\n  var numbers = onlyNumbers(input)\n  var currency = numbersToCurrency(numbers, opt.precision)\n  var parts = toStr(currency).split('.')\n  var integer = parts[0]\n  var decimal = parts[1]\n  integer = addThousandSeparator(integer, opt.thousands)\n  return opt.prefix + negative + joinIntegerAndDecimal(integer, decimal, opt.decimal) + opt.suffix\n}\n\nfunction unformat(input, precision) {\n  input = persianToEnglish(input)\n\n  var negative = input.indexOf('-') >= 0 ? -1 : 1\n  var numbers = onlyNumbers(input)\n  var currency = numbersToCurrency(numbers, precision)\n  return parseFloat(currency) * negative\n}\n\nfunction onlyNumbers(input) {\n  input = persianToEnglish(input)\n\n  return toStr(input).replace(/\\D+/g, '') || '0'\n}\n\n// Uncaught RangeError: toFixed() digits argument must be between 0 and 20 at Number.toFixed\nfunction fixed (precision) {\n  return between(0, precision, 20)\n}\n\nfunction between (min, n, max) {\n  return Math.max(min, Math.min(n, max))\n}\n\nfunction numbersToCurrency (numbers, precision) {\n  var exp = Math.pow(10, precision)\n  var float = parseFloat(numbers) / exp\n  return float.toFixed(fixed(precision))\n}\n\nfunction addThousandSeparator (integer, separator) {\n  return integer.replace(/(\\d)(?=(?:\\d{3})+\\b)/gm, `$1${separator}`)\n}\n\nfunction currencyToIntegerAndDecimal (float) {\n  return toStr(float).split('.')\n}\n\nfunction joinIntegerAndDecimal (integer, decimal, separator) {\n  return decimal ? integer + separator + decimal : integer\n}\n\nfunction toStr (value) {\n  return value ? value.toString() : ''\n}\n\nfunction setCursor (el, position) {\n  var setSelectionRange = function () { el.setSelectionRange(position, position) }\n  if (el === document.activeElement) {\n    setSelectionRange()\n    setTimeout(setSelectionRange, 1) // Android Fix\n  }\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#The_old-fashioned_way\nfunction event (name) {\n  var evt = document.createEvent('Event')\n  evt.initEvent(name, true, true)\n  return evt\n}\n\nexport {\n  format,\n  unformat,\n  setCursor,\n  event\n}\n","export default function (defaults, extras) {\n  defaults = defaults || {}\n  extras = extras || {}\n  return Object.keys(defaults).concat(Object.keys(extras)).reduce( function (acc, val) {\n    acc[val] = extras[val] === undefined ? defaults[val] : extras[val]\n    return acc\n  }, {})\n}\n","import {format, setCursor, event} from './utils'\nimport assign from './assign'\nimport defaults from './options'\n\nexport default function (el, binding) {\n  if (!binding.value) return\n  var opt = assign(defaults, binding.value)\n\n  // v-money used on a component that's not a input\n  if (el.tagName.toLocaleUpperCase() !== 'INPUT') {\n    var els = el.getElementsByTagName('input')\n    if (els.length !== 1) {\n      // throw new Error(\"v-money requires 1 input, found \" + els.length)\n    } else {\n      el = els[0]\n    }\n  }\n\n  el.oninput = function () {\n    var positionFromEnd = el.value.length - el.selectionEnd\n    el.value = format(el.value, opt)\n    positionFromEnd = Math.max(positionFromEnd, opt.suffix.length) // right\n    positionFromEnd = el.value.length - positionFromEnd\n    positionFromEnd = Math.max(positionFromEnd, opt.prefix.length + 1) // left\n    setCursor(el, positionFromEnd)\n    el.dispatchEvent(event('change')) // v-model.lazy\n  }\n\n  el.onfocus = function () {\n    setCursor(el, el.value.length - opt.suffix.length)\n  }\n\n  el.oninput()\n  el.dispatchEvent(event('input')) // force format after initialization\n}\n","<template lang=\"html\">\n  <input type=\"tel\"\n         :value=\"formattedValue\"\n         @change=\"change\"\n         v-money=\"{precision, decimal, thousands, prefix, suffix}\"\n         class=\"v-money\" />\n</template>\n\n<script>\nimport money from './directive'\nimport defaults from './options'\nimport {format, unformat} from './utils'\n\nexport default {\n  name: 'Money',\n  props: {\n    value: {\n      required: true,\n      type: [Number, String],\n      default: 0\n    },\n    masked: {\n      type: Boolean,\n      default: false\n    },\n    precision: {\n      type: Number,\n      default: () => defaults.precision\n    },\n    decimal: {\n      type: String,\n      default: () => defaults.decimal\n    },\n    thousands: {\n      type: String,\n      default: () => defaults.thousands\n    },\n    prefix: {\n      type: String,\n      default: () => defaults.prefix\n    },\n    suffix: {\n      type: String,\n      default: () => defaults.suffix\n    }\n  },\n\n  directives: {money},\n\n  data () {\n    return {\n      formattedValue: ''\n    }\n  },\n\n  watch: {\n    value: {\n      immediate: true,\n      handler (newValue, oldValue) {\n        var formatted = format(newValue, this.$props)\n        if (formatted !== this.formattedValue) {\n          this.formattedValue = formatted\n        }\n      }\n    }\n  },\n\n  methods: {\n    change (evt) {\n      this.$emit('input', this.masked ? evt.target.value : unformat(evt.target.value, this.precision))\n    }\n  }\n}\n</script>\n","import Money from './component.vue'\nimport VMoney from './directive'\nimport options from './options'\n\nexport {\n  Money,\n  VMoney,\n  options\n}\n\nfunction install (Vue, globalOptions) {\n  if (globalOptions) {\n    Object.keys(globalOptions).map(function(key){\n      options[key] = globalOptions[key]\n    })\n  }\n  Vue.directive('money', VMoney)\n  Vue.component('money', Money)\n}\n\nexport default install\n\n// Install by default if included from script tag\nif (typeof window !== 'undefined' && window.Vue) {\n  window.Vue.use(install)\n}\n"],"names":["prefix","suffix","thousands","decimal","precision","persianToEnglishMapper","mapChars","input","mapper","split","map","char","join","persianToEnglish","format","opt","defaults","negative","toFixed","fixed","indexOf","parts","toStr","numbersToCurrency","onlyNumbers","integer","addThousandSeparator","joinIntegerAndDecimal","unformat","currency","parseFloat","replace","between","min","n","max","Math","numbers","exp","pow","separator","value","toString","setCursor","el","position","setSelectionRange","document","activeElement","setTimeout","event","name","evt","createEvent","initEvent","extras","Object","keys","concat","reduce","acc","val","undefined","binding","assign","tagName","toLocaleUpperCase","els","getElementsByTagName","length","oninput","positionFromEnd","selectionEnd","dispatchEvent","onfocus","render","props","required","type","Number","String","default","masked","Boolean","directives","money","data","formattedValue","watch","immediate","handler","newValue","oldValue","formatted","this","$props","methods","change","$emit","target","install","Vue","globalOptions","key","options","directive","VMoney","component","Money","window","use"],"mappings":"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"}