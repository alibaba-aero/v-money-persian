{"version":3,"file":"v-money-persian.cjs.min.js","sources":["../src/options.js","../src/utils.js","../src/assign.js","../src/directive.js","../src/component.vue","../src/index.js"],"sourcesContent":["export default {\n  prefix: '',\n  suffix: '',\n  thousands: ',',\n  decimal: '.',\n  precision: 2\n}\n","import defaults from './options'\nimport { persianToEnglish } from './utils.persian.js'\n\nfunction format (input, opt = defaults) {\n  if (typeof input === 'number') {\n    input = input.toFixed(fixed(opt.precision))\n  } else {\n    input = peraianToEnglish(input)\n  }\n  var negative = input.indexOf('-') >= 0 ? '-' : ''\n\n  var numbers = onlyNumbers(input)\n  var currency = numbersToCurrency(numbers, opt.precision)\n  var parts = toStr(currency).split('.')\n  var integer = parts[0]\n  var decimal = parts[1]\n  integer = addThousandSeparator(integer, opt.thousands)\n  return opt.prefix + negative + joinIntegerAndDecimal(integer, decimal, opt.decimal) + opt.suffix\n}\n\nfunction unformat(input, precision) {\n  input = peraianToEnglish(input)\n\n  var negative = input.indexOf('-') >= 0 ? -1 : 1\n  var numbers = onlyNumbers(input)\n  var currency = numbersToCurrency(numbers, precision)\n  return parseFloat(currency) * negative\n}\n\nfunction onlyNumbers(input) {\n  input = peraianToEnglish(input)\n\n  return toStr(input).replace(/\\D+/g, '') || '0'\n}\n\n// Uncaught RangeError: toFixed() digits argument must be between 0 and 20 at Number.toFixed\nfunction fixed (precision) {\n  return between(0, precision, 20)\n}\n\nfunction between (min, n, max) {\n  return Math.max(min, Math.min(n, max))\n}\n\nfunction numbersToCurrency (numbers, precision) {\n  var exp = Math.pow(10, precision)\n  var float = parseFloat(numbers) / exp\n  return float.toFixed(fixed(precision))\n}\n\nfunction addThousandSeparator (integer, separator) {\n  return integer.replace(/(\\d)(?=(?:\\d{3})+\\b)/gm, `$1${separator}`)\n}\n\nfunction currencyToIntegerAndDecimal (float) {\n  return toStr(float).split('.')\n}\n\nfunction joinIntegerAndDecimal (integer, decimal, separator) {\n  return decimal ? integer + separator + decimal : integer\n}\n\nfunction toStr (value) {\n  return value ? value.toString() : ''\n}\n\nfunction setCursor (el, position) {\n  var setSelectionRange = function () { el.setSelectionRange(position, position) }\n  if (el === document.activeElement) {\n    setSelectionRange()\n    setTimeout(setSelectionRange, 1) // Android Fix\n  }\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#The_old-fashioned_way\nfunction event (name) {\n  var evt = document.createEvent('Event')\n  evt.initEvent(name, true, true)\n  return evt\n}\n\nexport {\n  format,\n  unformat,\n  setCursor,\n  event\n}\n","export default function (defaults, extras) {\n  defaults = defaults || {}\n  extras = extras || {}\n  return Object.keys(defaults).concat(Object.keys(extras)).reduce( function (acc, val) {\n    acc[val] = extras[val] === undefined ? defaults[val] : extras[val]\n    return acc\n  }, {})\n}\n","import {format, setCursor, event} from './utils'\nimport assign from './assign'\nimport defaults from './options'\n\nexport default function (el, binding) {\n  if (!binding.value) return\n  var opt = assign(defaults, binding.value)\n\n  // v-money used on a component that's not a input\n  if (el.tagName.toLocaleUpperCase() !== 'INPUT') {\n    var els = el.getElementsByTagName('input')\n    if (els.length !== 1) {\n      // throw new Error(\"v-money requires 1 input, found \" + els.length)\n    } else {\n      el = els[0]\n    }\n  }\n\n  el.oninput = function () {\n    var positionFromEnd = el.value.length - el.selectionEnd\n    el.value = format(el.value, opt)\n    positionFromEnd = Math.max(positionFromEnd, opt.suffix.length) // right\n    positionFromEnd = el.value.length - positionFromEnd\n    positionFromEnd = Math.max(positionFromEnd, opt.prefix.length + 1) // left\n    setCursor(el, positionFromEnd)\n    el.dispatchEvent(event('change')) // v-model.lazy\n  }\n\n  el.onfocus = function () {\n    setCursor(el, el.value.length - opt.suffix.length)\n  }\n\n  el.oninput()\n  el.dispatchEvent(event('input')) // force format after initialization\n}\n","<template lang=\"html\">\n  <input type=\"tel\"\n         :value=\"formattedValue\"\n         @change=\"change\"\n         v-money=\"{precision, decimal, thousands, prefix, suffix}\"\n         class=\"v-money\" />\n</template>\n\n<script>\nimport money from './directive'\nimport defaults from './options'\nimport {format, unformat} from './utils'\n\nexport default {\n  name: 'Money',\n  props: {\n    value: {\n      required: true,\n      type: [Number, String],\n      default: 0\n    },\n    masked: {\n      type: Boolean,\n      default: false\n    },\n    precision: {\n      type: Number,\n      default: () => defaults.precision\n    },\n    decimal: {\n      type: String,\n      default: () => defaults.decimal\n    },\n    thousands: {\n      type: String,\n      default: () => defaults.thousands\n    },\n    prefix: {\n      type: String,\n      default: () => defaults.prefix\n    },\n    suffix: {\n      type: String,\n      default: () => defaults.suffix\n    }\n  },\n\n  directives: {money},\n\n  data () {\n    return {\n      formattedValue: ''\n    }\n  },\n\n  watch: {\n    value: {\n      immediate: true,\n      handler (newValue, oldValue) {\n        var formatted = format(newValue, this.$props)\n        if (formatted !== this.formattedValue) {\n          this.formattedValue = formatted\n        }\n      }\n    }\n  },\n\n  methods: {\n    change (evt) {\n      this.$emit('input', this.masked ? evt.target.value : unformat(evt.target.value, this.precision))\n    }\n  }\n}\n</script>\n","import Money from './component.vue'\nimport VMoney from './directive'\nimport options from './options'\nconst VERSION = proccess.env.VERSION\n\nexport {\n  Money,\n  VMoney,\n  options,\n  VERSION\n}\n\nfunction install (Vue, globalOptions) {\n  if (globalOptions) {\n    Object.keys(globalOptions).map(function(key){\n      options[key] = globalOptions[key]\n    })\n  }\n  Vue.directive('money', VMoney)\n  Vue.component('money', Money)\n}\n\nexport default install\n\n// Install by default if included from script tag\nif (typeof window !== 'undefined' && window.Vue) {\n  window.Vue.use(install)\n}\n"],"names":["prefix","suffix","thousands","decimal","precision","format","input","opt","defaults","negative","toFixed","fixed","peraianToEnglish","indexOf","parts","toStr","numbersToCurrency","onlyNumbers","split","integer","addThousandSeparator","joinIntegerAndDecimal","unformat","currency","parseFloat","replace","between","min","n","max","Math","numbers","exp","pow","separator","value","toString","setCursor","el","position","setSelectionRange","document","activeElement","setTimeout","event","name","evt","createEvent","initEvent","extras","Object","keys","concat","reduce","acc","val","undefined","binding","assign","tagName","toLocaleUpperCase","els","getElementsByTagName","length","oninput","positionFromEnd","selectionEnd","dispatchEvent","onfocus","render","props","required","type","Number","String","default","masked","Boolean","directives","money","data","formattedValue","watch","immediate","handler","newValue","oldValue","formatted","this","$props","methods","change","$emit","target","VERSION","proccess","env","install","Vue","globalOptions","map","key","options","directive","VMoney","component","Money","window","use"],"mappings":"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"}