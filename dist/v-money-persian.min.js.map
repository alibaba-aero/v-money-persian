{"version":3,"file":"v-money-persian.min.js","sources":["../src/options.js","../src/utils.persian.js","../src/utils.js","../src/directive.js","../src/assign.js","../src/component.vue","../src/index.js"],"sourcesContent":["export default {\n  prefix: '',\n  suffix: '',\n  thousands: ',',\n  decimal: '.',\n  precision: 2\n}\n","const persianToEnglishMapper = {\n  '۱': 1,\n  '۲': 2,\n  '۳': 3,\n  '۴': 4,\n  '۵': 5,\n  '۶': 6,\n  '۷': 7,\n  '۸': 8,\n  '۹': 9,\n  '۰': 0\n}\n\nfunction mapChars(input, mapper) {\n  return input.split('').map(char => {\n    return mapper[char] || char;\n  }).join('');\n}\n\nexport function persianToEnglish(input) {\n  return mapChars(input, persianToEnglishMapper);\n}\n","import defaults from './options'\nimport { persianToEnglish } from './utils.persian.js'\n\nfunction format (input, opt = defaults) {\n  if (typeof input === 'number') {\n    input = input.toFixed(fixed(opt.precision))\n  } else {\n    input = persianToEnglish(input)\n  }\n  var negative = input.indexOf('-') >= 0 ? '-' : ''\n\n  var numbers = onlyNumbers(input)\n  var currency = numbersToCurrency(numbers, opt.precision)\n  var parts = toStr(currency).split('.')\n  var integer = parts[0]\n  var decimal = parts[1]\n  integer = addThousandSeparator(integer, opt.thousands)\n  return opt.prefix + negative + joinIntegerAndDecimal(integer, decimal, opt.decimal) + opt.suffix\n}\n\nfunction unformat(input, precision) {\n  input = persianToEnglish(input)\n\n  var negative = input.indexOf('-') >= 0 ? -1 : 1\n  var numbers = onlyNumbers(input)\n  var currency = numbersToCurrency(numbers, precision)\n  return parseFloat(currency) * negative\n}\n\nfunction onlyNumbers(input) {\n  input = persianToEnglish(input)\n\n  return toStr(input).replace(/\\D+/g, '') || '0'\n}\n\n// Uncaught RangeError: toFixed() digits argument must be between 0 and 20 at Number.toFixed\nfunction fixed (precision) {\n  return between(0, precision, 20)\n}\n\nfunction between (min, n, max) {\n  return Math.max(min, Math.min(n, max))\n}\n\nfunction numbersToCurrency (numbers, precision) {\n  var exp = Math.pow(10, precision)\n  var float = parseFloat(numbers) / exp\n  return float.toFixed(fixed(precision))\n}\n\nfunction addThousandSeparator (integer, separator) {\n  return integer.replace(/(\\d)(?=(?:\\d{3})+\\b)/gm, `$1${separator}`)\n}\n\nfunction currencyToIntegerAndDecimal (float) {\n  return toStr(float).split('.')\n}\n\nfunction joinIntegerAndDecimal (integer, decimal, separator) {\n  return decimal ? integer + separator + decimal : integer\n}\n\nfunction toStr (value) {\n  return value ? value.toString() : ''\n}\n\nfunction setCursor (el, position) {\n  var setSelectionRange = function () { el.setSelectionRange(position, position) }\n  if (el === document.activeElement) {\n    setSelectionRange()\n    setTimeout(setSelectionRange, 1) // Android Fix\n  }\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#The_old-fashioned_way\nfunction event (name) {\n  var evt = document.createEvent('Event')\n  evt.initEvent(name, true, true)\n  return evt\n}\n\nexport {\n  format,\n  unformat,\n  setCursor,\n  event\n}\n","import {format, setCursor, event} from './utils'\nimport assign from './assign'\nimport defaults from './options'\n\nexport default function (el, binding) {\n  if (!binding.value) return\n  var opt = assign(defaults, binding.value)\n\n  // v-money used on a component that's not a input\n  if (el.tagName.toLocaleUpperCase() !== 'INPUT') {\n    var els = el.getElementsByTagName('input')\n    if (els.length !== 1) {\n      // throw new Error(\"v-money requires 1 input, found \" + els.length)\n    } else {\n      el = els[0]\n    }\n  }\n\n  el.oninput = function () {\n    var positionFromEnd = el.value.length - el.selectionEnd\n    el.value = format(el.value, opt)\n    positionFromEnd = Math.max(positionFromEnd, opt.suffix.length) // right\n    positionFromEnd = el.value.length - positionFromEnd\n    positionFromEnd = Math.max(positionFromEnd, opt.prefix.length + 1) // left\n    setCursor(el, positionFromEnd)\n    el.dispatchEvent(event('change')) // v-model.lazy\n  }\n\n  el.onfocus = function () {\n    setCursor(el, el.value.length - opt.suffix.length)\n  }\n\n  el.oninput()\n  el.dispatchEvent(event('input')) // force format after initialization\n}\n","export default function (defaults, extras) {\n  defaults = defaults || {}\n  extras = extras || {}\n  return Object.keys(defaults).concat(Object.keys(extras)).reduce( function (acc, val) {\n    acc[val] = extras[val] === undefined ? defaults[val] : extras[val]\n    return acc\n  }, {})\n}\n","<template lang=\"html\">\n  <input type=\"tel\"\n         :value=\"formattedValue\"\n         @change=\"change\"\n         v-money=\"{precision, decimal, thousands, prefix, suffix}\"\n         class=\"v-money\" />\n</template>\n\n<script>\nimport money from './directive'\nimport defaults from './options'\nimport {format, unformat} from './utils'\n\nexport default {\n  name: 'Money',\n  props: {\n    value: {\n      required: true,\n      type: [Number, String],\n      default: 0\n    },\n    masked: {\n      type: Boolean,\n      default: false\n    },\n    precision: {\n      type: Number,\n      default: () => defaults.precision\n    },\n    decimal: {\n      type: String,\n      default: () => defaults.decimal\n    },\n    thousands: {\n      type: String,\n      default: () => defaults.thousands\n    },\n    prefix: {\n      type: String,\n      default: () => defaults.prefix\n    },\n    suffix: {\n      type: String,\n      default: () => defaults.suffix\n    }\n  },\n\n  directives: {money},\n\n  data () {\n    return {\n      formattedValue: ''\n    }\n  },\n\n  watch: {\n    value: {\n      immediate: true,\n      handler (newValue, oldValue) {\n        var formatted = format(newValue, this.$props)\n        if (formatted !== this.formattedValue) {\n          this.formattedValue = formatted\n        }\n      }\n    }\n  },\n\n  methods: {\n    change (evt) {\n      this.$emit('input', this.masked ? evt.target.value : unformat(evt.target.value, this.precision))\n    }\n  }\n}\n</script>\n","import Money from './component.vue'\nimport VMoney from './directive'\nimport options from './options'\n\nexport {\n  Money,\n  VMoney,\n  options\n}\n\nfunction install (Vue, globalOptions) {\n  if (globalOptions) {\n    Object.keys(globalOptions).map(function(key){\n      options[key] = globalOptions[key]\n    })\n  }\n  Vue.directive('money', VMoney)\n  Vue.component('money', Money)\n}\n\nexport default install\n\n// Install by default if included from script tag\nif (typeof window !== 'undefined' && window.Vue) {\n  window.Vue.use(install)\n}\n"],"names":["prefix","suffix","thousands","decimal","precision","persianToEnglishMapper","persianToEnglish","input","mapper","split","map","char","join","mapChars","format","opt","defaults","negative","toFixed","fixed","indexOf","parts","toStr","numbersToCurrency","onlyNumbers","integer","separator","replace","addThousandSeparator","joinIntegerAndDecimal","min","n","max","Math","numbers","exp","pow","parseFloat","value","toString","setCursor","el","position","setSelectionRange","document","activeElement","setTimeout","event","name","evt","createEvent","initEvent","binding","extras","Object","keys","concat","reduce","acc","val","undefined","assign","tagName","toLocaleUpperCase","els","getElementsByTagName","length","oninput","positionFromEnd","selectionEnd","dispatchEvent","onfocus","render","props","required","type","Number","String","default","masked","Boolean","directives","money","data","formattedValue","watch","immediate","handler","newValue","oldValue","formatted","this","$props","methods","change","currency","$emit","target","install","Vue","globalOptions","key","options","directive","VMoney","component","Money","window","use"],"mappings":"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"}